<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Bài viết về hành trình trưởng thành</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 32px 16px;
            background: #fafafa;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1.hover-title {
            text-align: center;
            font-size: 2.5em;
            color: #388e3c;
            margin-top: 32px;
            letter-spacing: 2px;
            text-shadow: 1px 2px 8px #b2dfdb;
            border: 3px solid #388e3c;
            border-radius: 16px;
            padding: 16px 0;
            background: #e8f5e9;
            user-select: text;
        }
        .frame {
            max-width: 700px;
            margin: 24px auto;
            border: 3px solid #388e3c;
            border-radius: 16px;
            background: #e8f5e9;
            display: flex;
            flex-direction: row;
            align-items: flex-start;
            padding: 16px;
            gap: 20px;
            flex-wrap: wrap;
        }
        .frame img {
            width: 140px;
            height: 140px;
            object-fit: cover;
            border-radius: 12px;
            animation: float 3s ease-in-out infinite alternate;
        }
        @keyframes float {
            0%   { transform: translateY(0); }
            100% { transform: translateY(-10px); }
        }
        .frame-text {
            flex: 1 1 300px;
            display: flex;
            flex-direction: column;
            min-width: 0;
        }
        .frame-text strong {
            font-size: 1.2em;
            color: #2e7d32;
            margin-bottom: 12px;
            user-select: text;
        }
        #frame-desc-editable {
            flex-grow: 1;
            resize: vertical;
            font-size: 1em;
            padding: 10px 12px;
            border-radius: 8px;
            border: 1px solid #a5d6a7;
            min-height: 90px;
            font-family: Arial, sans-serif;
            color: #2f2f2f;
            max-height: 200px;
            overflow-y: auto;
        }
        #editable-content {
            max-width: 700px;
            width: 100%;
            min-height: 220px;
            margin: 24px auto 0 auto;
            padding: 16px;
            font-size: 1em;
            border-radius: 8px;
            border: 1px solid #ccc;
            resize: vertical;
            font-family: Arial, sans-serif;
            box-sizing: border-box;
        }
        #status {
            text-align: center;
            color: gray;
            margin-top: 8px;
            font-style: italic;
            font-size: 0.9em;
        }
        .btn-wrapper {
            display: flex;
            justify-content: center;
            margin-top: 24px;
            padding-left: 16px;
            border-left: 2px solid #ccc; /* Đường kẻ bên trái nút "Quay lại" */
            gap: 12px;
            flex-wrap: wrap;
        }
        .btn-back {
            padding: 10px 24px;
            font-size: 1em;
            color: #fff;
            background-color: #388e3c;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            text-decoration: none;
            user-select: none;
            transition: background-color 0.3s ease;
        }
        .btn-back:hover {
            background-color: #2e7d32;
        }
        .btn-improve {
            padding: 10px 24px;
            font-size: 1em;
            color: #fff;
            background-color: #f57c00;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            user-select: none;
            transition: background-color 0.3s ease;
        }
        .btn-improve:hover {
            background-color: #ef6c00;
        }
    </style>
</head>
<body>

    <h1 class="hover-title" contenteditable="true" id="page-title" spellcheck="false" title="Chỉnh sửa tiêu đề bài viết">
        Hành Trình Trưởng Thành
    </h1>

    <div class="frame" title="Khung nội dung hình ảnh và mô tả">
        <img src="https://images.pexels.com/photos/91227/pexels-photo-91227.jpeg" alt="Ảnh hành trình trưởng thành" id="frame-image" />
        <div class="frame-text">
            <strong id="frame-title" contenteditable="true" spellcheck="false" title="Chỉnh sửa tiêu đề nhỏ trong khung">Bước Chân Đầu Đời</strong>
            <textarea id="frame-desc-editable" maxlength="500" placeholder="Nhập mô tả ở đây (tối đa 500 ký tự)"></textarea>
            <div style="margin-top: 12px;">
                <input type="file" id="upload-image" accept="image/*" />
                <button onclick="downloadImage()" style="margin-left: 10px;">Tải ảnh xuống</button>
            </div>
        </div>
    </div>

    <textarea id="editable-content" spellcheck="false" placeholder="Nhập nội dung bài viết ở đây..."></textarea>

    <div class="btn-wrapper">
        <button class="btn-improve" onclick="improveText()">Cải thiện nội dung</button>
        <a href="../index.html" class="btn-back">Quay lại</a>
    </div>

    <p id="status">Chưa lưu</p>

    <script>
        const pageTitle = document.getElementById('page-title');
        const frameTitle = document.getElementById('frame-title');
        const frameDesc = document.getElementById('frame-desc-editable');
        const content = document.getElementById('editable-content');
        const frameImage = document.getElementById('frame-image');
        const status = document.getElementById('status');

        const defaults = {
            pageTitle: 'Hành Trình Trưởng Thành',
            frameTitle: 'Bước Chân Đầu Đời',
            frameDesc: `Trưởng thành là một hành trình dài với nhiều thử thách và trải nghiệm.
Mỗi bước đi đều mang theo những bài học quý giá, từ những vấp ngã đầu tiên cho đến những thành công nhỏ bé.
Có lúc ta cảm thấy lạc lõng giữa ngã rẽ cuộc đời, nhưng chính những khó khăn ấy lại giúp ta mạnh mẽ hơn từng ngày.

Trên con đường ấy, ta học cách chấp nhận bản thân, biết ơn những người đồng hành và không ngừng cố gắng để trở thành phiên bản tốt hơn của chính mình.
Dù phía trước còn nhiều điều chưa biết, nhưng mỗi ngày trôi qua đều là một dấu mốc đáng nhớ trong hành trình trưởng thành.`,
            content: `Trưởng thành không chỉ là lớn lên về tuổi tác, mà còn là sự trưởng thành trong tâm hồn, suy nghĩ và cách sống.
Đó là hành trình tự khám phá, tự hoàn thiện và dám đối diện với chính mình.`
        };

        // Load dữ liệu từ localStorage hoặc mặc định
        pageTitle.textContent = localStorage.getItem('pageTitle') || defaults.pageTitle;
        frameTitle.textContent = localStorage.getItem('frameTitle') || defaults.frameTitle;
        frameDesc.value = localStorage.getItem('frameDesc') || defaults.frameDesc;
        content.value = localStorage.getItem('content') || defaults.content;

        // Ảnh lưu trên localStorage
        const savedImage = localStorage.getItem('frameImage');
        if (savedImage) {
            frameImage.src = savedImage;
        }

        let timer = null;
        function scheduleSave() {
            status.textContent = 'Đang soạn...';
            clearTimeout(timer);
            timer = setTimeout(() => {
                const newPageTitle = pageTitle.textContent.trim() || defaults.pageTitle;
                let newFrameDesc = frameDesc.value.trim();
                if (newFrameDesc.length > 500) {
                    newFrameDesc = newFrameDesc.substring(0, 500);
                    frameDesc.value = newFrameDesc;
                    alert('Mô tả tối đa 500 ký tự.');
                }
                const newFrameTitle = frameTitle.textContent.trim() || defaults.frameTitle;
                const newContent = content.value;

                localStorage.setItem('pageTitle', newPageTitle);
                localStorage.setItem('frameTitle', newFrameTitle);
                localStorage.setItem('frameDesc', newFrameDesc);
                localStorage.setItem('content', newContent);

                status.textContent = 'Đã lưu lúc: ' + new Date().toLocaleTimeString();
            }, 3000);
        }

        [pageTitle, frameTitle].forEach(el => el.addEventListener('input', scheduleSave));
        frameDesc.addEventListener('input', scheduleSave);
        content.addEventListener('input', scheduleSave);

        document.getElementById('upload-image').addEventListener('change', function (e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function (event) {
                const dataUrl = event.target.result;
                frameImage.src = dataUrl;
                localStorage.setItem('frameImage', dataUrl);
                status.textContent = 'Ảnh đã được thay đổi và lưu.';
            };
            reader.readAsDataURL(file);
        });

        function downloadImage() {
            const a = document.createElement('a');
            a.href = frameImage.src;
            a.download = 'hanh-trinh-truong-thanh.jpg';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        // Hàm cải thiện nội dung đơn giản
        function improveText() {
            let text = content.value.trim();
            if (!text) {
                alert('Vui lòng nhập nội dung trước khi cải thiện.');
                return;
            }
            // Tách câu theo dấu chấm
            let sentences = text.split('.').map(s => s.trim()).filter(s => s.length > 0);
            sentences = sentences.map(s => s.charAt(0).toUpperCase() + s.slice(1));
            let improved = sentences.join('. ') + '.\n\nNội dung đã được cải thiện để rõ ràng hơn.';
            content.value = improved;

            status.textContent = 'Nội dung đã được cải thiện!';
            scheduleSave();
        }
    </script>
</body>
</html>
